FROM node:$VERSION

# Vault installation
RUN apt-get update && apt-get install -y unzip
RUN curl -L "https://releases.hashicorp.com/vault/0.7.0/vault_0.7.0_linux_amd64.zip" > /tmp/vault.zip
WORKDIR /tmp
RUN unzip vault.zip && mv vault /usr/local/bin && chmod 0755 /usr/local/bin/vault


RUN mkdir -p /usr/src/app
WORKDIR /usr/src/app

COPY . .
RUN npm install -q --no-progress
RUN npm install -q --no-progress config

CMD npm test
#CMD npm test && \
#    npm run lint
